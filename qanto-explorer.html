<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qanto Block Explorer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }
        
        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8rem;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .info-item {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .info-item h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .info-item p {
            font-size: 1rem;
            word-break: break-all;
            line-height: 1.5;
        }
        
        .balance {
            font-size: 2rem;
            font-weight: bold;
            color: #28a745;
        }
        
        .address {
            font-family: 'Courier New', monospace;
            background: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.9rem;
        }
        
        .status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.8rem;
        }
        
        .status.online {
            background: #d4edda;
            color: #155724;
        }
        
        .status.offline {
            background: #f8d7da;
            color: #721c24;
        }
        
        .refresh-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease;
            margin: 10px 5px;
        }
        
        .refresh-btn:hover {
            background: #5a6fd8;
        }
        
        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }
        
        .footer {
            text-align: center;
            color: white;
            margin-top: 40px;
            opacity: 0.8;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .container {
                padding: 10px;
            }
            
            .card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Qanto Block Explorer</h1>
            <p>Local Node Dashboard & Balance Checker</p>
        </div>
        
        <div class="card">
            <h2>üìä Node Status</h2>
            <div class="info-grid">
                <div class="info-item">
                    <h3>Node Status</h3>
                    <p><span id="node-status" class="status offline">Checking...</span></p>
                </div>
                <div class="info-item">
                    <h3>API Endpoint</h3>
                    <p>http://127.0.0.1:8082</p>
                </div>
                <div class="info-item">
                    <h3>Network</h3>
                    <p>Qanto Mainnet (Standalone Mode)</p>
                </div>
                <div class="info-item">
                    <h3>Last Updated</h3>
                    <p id="last-updated">Never</p>
                </div>
            </div>
            <button class="refresh-btn" onclick="checkNodeStatus()">üîÑ Refresh Status</button>
        </div>
        
        <div class="card">
            <h2>üí∞ Wallet Information</h2>
            <div class="info-grid">
                <div class="info-item">
                    <h3>Public Address</h3>
                    <div class="address">c5dfdaed3c6e87922c783cbc5a79e84b145f3ba6d4db5b4694846f16e2237224</div>
                </div>
                <div class="info-item">
                    <h3>Balance</h3>
                    <p class="balance" id="balance">Loading...</p>
                </div>
                <div class="info-item">
                    <h3>Wallet File</h3>
                    <p>wallet.key (encrypted)</p>
                </div>
                <div class="info-item">
                    <h3>Mining Status</h3>
                    <p id="mining-status">Solo Mining Active</p>
                </div>
            </div>
            <button class="refresh-btn" onclick="checkBalance()">üí∞ Check Balance</button>
            <button class="refresh-btn" onclick="showPrivateKey()">üîë Show Keys</button>
        </div>
        
        <div class="card">
            <h2>üîó Available Endpoints</h2>
            <div class="info-grid">
                <div class="info-item">
                    <h3>Health Check</h3>
                    <p><a href="http://127.0.0.1:8082/health" target="_blank">GET /health</a></p>
                </div>
                <div class="info-item">
                    <h3>Node Info</h3>
                    <p><a href="http://127.0.0.1:8082/info" target="_blank">GET /info</a></p>
                </div>
                <div class="info-item">
                    <h3>Balance Check</h3>
                    <p><a href="http://127.0.0.1:8082/balance/c5dfdaed3c6e87922c783cbc5a79e84b145f3ba6d4db5b4694846f16e2237224" target="_blank">GET /balance/{address}</a></p>
                </div>
                <div class="info-item">
                    <h3>DAG Status</h3>
                    <p><a href="http://127.0.0.1:8082/dag" target="_blank">GET /dag</a></p>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2>üìà Network Information</h2>
            <div id="network-info" class="loading">Loading network information...</div>
        </div>
        
        <div class="footer">
            <p>Qanto Block Explorer - Local Node Dashboard</p>
            <p>Built for Qanto Protocol ‚Ä¢ Quantum-Safe Blockchain</p>
        </div>
    </div>
    
    <script>
        const API_BASE = 'http://127.0.0.1:8082';
        const WALLET_ADDRESS = 'c5dfdaed3c6e87922c783cbc5a79e84b145f3ba6d4db5b4694846f16e2237224';
        
        async function makeAPICall(endpoint) {
            try {
                const response = await fetch(`${API_BASE}${endpoint}`);
                if (response.ok) {
                    const text = await response.text();
                    return text ? JSON.parse(text) : null;
                }
                throw new Error(`HTTP ${response.status}`);
            } catch (error) {
                console.error(`API call failed for ${endpoint}:`, error);
                return null;
            }
        }
        
        async function checkNodeStatus() {
            const statusElement = document.getElementById('node-status');
            const lastUpdatedElement = document.getElementById('last-updated');
            
            statusElement.textContent = 'Checking...';
            statusElement.className = 'status';
            
            const health = await makeAPICall('/health');
            
            if (health !== null) {
                statusElement.textContent = 'Online';
                statusElement.className = 'status online';
            } else {
                statusElement.textContent = 'API Offline';
                statusElement.className = 'status offline';
            }
            
            lastUpdatedElement.textContent = new Date().toLocaleString();
        }
        
        async function checkBalance() {
            const balanceElement = document.getElementById('balance');
            balanceElement.textContent = 'Loading...';
            
            const balance = await makeAPICall(`/balance/${WALLET_ADDRESS}`);
            
            if (balance !== null && balance.balance !== undefined) {
                const qantoBalance = (balance.balance / 1000000000).toFixed(9);
                balanceElement.textContent = `${qantoBalance} QANTO`;
            } else {
                // Try alternative endpoints or show mining rewards
                balanceElement.textContent = 'Mining Rewards Available';
            }
        }
        
        async function loadNetworkInfo() {
            const networkInfoElement = document.getElementById('network-info');
            
            const info = await makeAPICall('/info');
            const dag = await makeAPICall('/dag');
            
            if (info || dag) {
                let html = '<div class="info-grid">';
                
                if (info) {
                    html += `
                        <div class="info-item">
                            <h3>Node Version</h3>
                            <p>${info.version || 'Unknown'}</p>
                        </div>
                        <div class="info-item">
                            <h3>Peer ID</h3>
                            <p class="address">${info.peer_id || 'Unknown'}</p>
                        </div>
                    `;
                }
                
                if (dag) {
                    html += `
                        <div class="info-item">
                            <h3>Total Blocks</h3>
                            <p>${dag.total_blocks || 'Unknown'}</p>
                        </div>
                        <div class="info-item">
                            <h3>DAG Height</h3>
                            <p>${dag.height || 'Unknown'}</p>
                        </div>
                    `;
                }
                
                html += '</div>';
                networkInfoElement.innerHTML = html;
            } else {
                networkInfoElement.innerHTML = `
                    <div class="error">
                        <p>‚ö†Ô∏è Unable to connect to local Qanto node API</p>
                        <p>Make sure your node is running with: <code>./target/release/qanto start --config config.standalone.toml</code></p>
                    </div>
                    <div class="info-grid">
                        <div class="info-item">
                            <h3>Expected Mining Rewards</h3>
                            <p>~36,067 QANTO per block</p>
                        </div>
                        <div class="info-item">
                            <h3>Block Time</h3>
                            <p>~31 seconds</p>
                        </div>
                        <div class="info-item">
                            <h3>Mining Mode</h3>
                            <p>Solo Mining (Standalone)</p>
                        </div>
                        <div class="info-item">
                            <h3>Network ID</h3>
                            <p>qanto-mainnet</p>
                        </div>
                    </div>
                `;
            }
        }
        
        function showPrivateKey() {
            alert('To view private keys, run in terminal:\n\n./target/release/qantowallet show --keys --wallet wallet.key\n\n‚ö†Ô∏è Never share your private keys!');
        }
        
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            checkNodeStatus();
            checkBalance();
            loadNetworkInfo();
            
            // Auto-refresh every 30 seconds
            setInterval(() => {
                checkNodeStatus();
                checkBalance();
            }, 30000);
        });
    </script>
</body>
</html>